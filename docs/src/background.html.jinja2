{% extends 'layout.jinja2' %}
{% import 'forms.jinja2' as f %}
{% block title %}{{ title | escape }}{% endblock %}

{% block body %}
    <div class="container-fluid" style="max-width:1550px">
        <h1>
            Sample, Sammy G
            <small class="text-muted" title="Study ID">ST0001</small>
        </h1>
        <h2>Background
            <small class="text-muted" title="Medical Record Number">1234567890</small>
        </h2>

        <hr>
        <form action="{{ formPage+".html" if mockup else "/vapals" }}" method="{{ formMethod }}" id="main-form"
              class="validated">
            <input type="hidden" name="samiroute" value="postform"/>
            <input type="hidden" name="studyid" value="@@SID@@"/>
            <input type="hidden" name="form" value="@@FORMKEY@@"/>

            <h3>Self-report of Comorbidities and Exposures</h3>

            <div class="row">
                <div class="col-sm-6 col-md-4">
                    <label for="sbahao-i" class="control-label">Have you ever worked in any of the
                        following?</label>
                </div>
                <div class="col-sm-6 col-md-8">
                    <div class="form-group">
                        {{ f.checkbox("sbahaoc", "ao", "Agent orange") }}
                        {{ f.checkbox("sbahaoi", "i", "Asbestos product manufacturing") }}
                        {{ f.checkbox("sbahaoj", "j", "Auto repair") }}
                        {{ f.checkbox("sbahaoh", "h", "Building maintenance") }}
                        {{ f.checkbox("sbahaoc", "bp", "Burn pits") }}
                        {{ f.checkbox("sbahaof", "f", "Chemical industry/foundary/refinery") }}
                        {{ f.checkbox("sbahaoa", "a", "Construction/demolition") }}
                        {{ f.checkbox("sbahaoe", "e", "Mining") }}
                        {{ f.checkbox("sbahaog", "g", "Nuclear industry") }}
                        {{ f.checkbox("sbahaoc", "c", "Ship construction/repair") }}
                        {{ f.checkbox("sbahaoo", "o", "Other") }}
                        <input class="form-control input-sm" type="text" name="sbahas" id="sbahas"
                               title="Other work" required="required">
                    </div>
                </div>
            </div>
            <hr class="visible-xs-block visible-sm-block"/>

            <div class="row">
                <div class="col-sm-6 col-md-4 col-lg-4">
                    <label for="sblcs-n">Have you experienced any symptoms indicative of lung cancer?</label>
                </div>
                <div class="col-sm-6 col-md-3 col-lg-2">
                    <div class="form-group">
                        {{ f.inlineRadio("sblcs","sblcs-n","n", "No") }}
                        {{ f.inlineRadio("sblcs","sblcs-y","y", "Yes") }}
                    </div>
                </div>
                <div class="col-sm-12 col-md-5 col-lg-6" id="sblcs-container" style="display: none;">
                    <div class="form-group">
                        <p><em>Check all that apply</em></p>
                        {{ f.checkbox("sbwcb", "b", "Cough producing bloody material") }}
                        {{ f.checkbox("sbwcl", "l", "Unexplained weight loss greater than 20 lbs.") }}
                        {{ f.checkbox("sbwch", "h", "Unexplained hoarseness") }}
                        {{ f.checkbox("sbwco", "o", "Other") }}
                        <input class="form-control input-sm" type="text" name="sbwcos"
                               id="sbwcos" title="Other symptom" required="required">
                    </div>
                </div>
            </div>
            <hr class="visible-xs-block visible-sm-block"/>

            <div class="row">
                <div class="col-sm-6 col-md-4 col-lg-4">
                    <label for="sbact" class="control-label">When did you most recently have a chest CT?</label>
                </div>
                <div class="col-sm-6 col-md-3 col-lg-2">
                    <div class="form-group">
                        <select id="sbact" name="sbact" class="form-control input-sm">
                            <option value="-">&mdash;</option>
                            <option value="a">Less than 6 months ago</option>
                            <option value="b">6â€“18 months ago</option>
                            <option value="f">18 months to 3 years ago</option>
                            <option value="c">3 years to 5 years ago</option>
                            <option value="d">Over 5 years ago</option>
                            <option value="e">Never</option>
                        </select>
                    </div>
                </div>
                <div class="col-sm-12 col-md-5 col-lg-6 form-inline" id="sbact-container" style="display: none;">
                    <div class="form-group">
                        <label for="sbahcl" class="control-label required">Where was the test done?</label>
                        <input type="text" name="sbahcl" id="sbahcl" class="form-control input-sm"
                               required="required"/>
                    </div>

                </div>
            </div>
            <hr class="visible-xs-block visible-sm-block"/>

            <div class="row">
                <div class="col-sm-6 col-md-4 col-lg-4">
                    <label for="sbahpft-n" class="control-label">Have you had a pulmonary function test
                        within the last five years?</label>
                </div>
                <div class="col-sm-6 col-md-3 col-lg-2">
                    <div class="form-group">
                        {{ f.inlineRadioNY("sbahpft") }}
                    </div>
                </div>

                <div class="col-sm-12 col-md-5 col-lg-6 form-inline" id="sbahpft-container" style="display: none;">
                    <div class="form-group">
                        <label for="sbfev1">FEV1 (L/s)</label>
                        <input class="form-control input-sm" type="text" name="sbfev1" id="sbfev1" size="4">
                    </div>
                    <div class="form-group">
                        <label for="sbfvc">FVC (L)</label>
                        <input class="form-control input-sm" type="text" name="sbfvc" id="sbfvc" size="4">
                    </div>
                    <div class="form-group">
                        <label for="sbcop">Diffusion capacity (mL/min/mm Hg)</label>
                        <input class="form-control input-sm" type="text" name="sbcop" id="sbcop" size="4">
                    </div>
                    <div class="alert alert-info" id="ffr-message" style="display: none; margin-top:5px;">
                        FEV1/FVC (%) is <strong><span id="ffr-value"></span></strong>
                    </div>
                    <input type="hidden" name="sbffr" id="sbffr"/>
                </div>
            </div>
            <hr class="visible-xs-block visible-sm-block"/>

            <label>Do you know if you have had any of the following?</label>

            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Cancers</h3>
                </div>
                <div class="panel-body">
                    <div class="row">
                        <div class="col-sm-6 col-md-3 col-lg-3">
                            {{ f.floatingLabel('sbfc-n', 'Family history of lung cancer') }}
                        </div>
                        <div class="col-sm-6 col-md-3 col-lg-2">
                            <div class="form-group">
                                {{ f.inlineRadioNYQ("sbfc") }}
                            </div>
                        </div>
                        <div id="sbfc-container" style="display: none;">
                            <div class="form-group col-sm-4 col-md-2">
                                <label class="control-label required" for="sbfcf-n">Father?</label><br/>
                                {{ f.inlineRadio("sbfcf","sbfcf-n","n", "No", true) }}
                                {{ f.inlineRadio("sbfcf","sbfcf-y","y", "Yes") }}
                            </div>
                            <div class="form-group col-sm-4 col-md-2">
                                <label class="control-label required" for="sbfcm-n">Mother?</label><br/>
                                {{ f.inlineRadio("sbfcm","sbfcm-n","n", "No", true) }}
                                {{ f.inlineRadio("sbfcm","sbfcm-y","y", "Yes") }}
                            </div>
                            <div class="form-group col-sm-4 col-md-2">
                                <label class="control-label required" for="sbfcs-n">Siblings?</label><br/>
                                {{ f.inlineRadio("sbfcs","sbfcs-n","n", "No", true) }}
                                {{ f.inlineRadio("sbfcs","sbfcs-y","y", "Yes") }}
                            </div>
                        </div>
                    </div>
                    <hr class="visible-xs-block visible-sm-block"/>

                    <div class="row">
                        <div class="col-sm-6 col-md-3 col-lg-3">
                            {{ f.floatingLabel('sbhlc-n', 'Lung cancer') }}
                        </div>
                        <div class="col-sm-6 col-md-3 col-lg-2">
                            <div class="form-group">
                                {{ f.inlineRadioNYQ("sbhlc") }}
                            </div>
                        </div>
                        <div id="sbhlc-container" style="display: none;">
                            <div class="form-group col-sm-4 col-md-2">
                                <label class="control-label required" for="sbhlcdt">Year</label>
                                {{ f.yearpicker("sbhlcdt", true, true) }}
                            </div>
                        </div>
                    </div>
                    <hr class="visible-xs-block visible-sm-block"/>

                    <div class="row">
                        <div class="col-sm-6 col-md-3 col-lg-3">
                            {{ f.floatingLabel('sbhme-n', 'Melanoma') }}
                        </div>
                        <div class="col-sm-6 col-md-3 col-lg-2">
                            <div class="form-group">
                                {{ f.inlineRadioNYQ("sbhme") }}
                            </div>
                        </div>
                        <div id="sbhme-container" style="display: none;">
                            <div class="form-group col-sm-4 col-md-2">
                                <label class="control-label required" for="sbhmedt">Year</label>
                                {{ f.yearpicker("sbhmedt", true, true) }}
                            </div>
                        </div>
                    </div>
                    <hr class="visible-xs-block visible-sm-block"/>

                    <div class="row">
                        <div class="col-sm-6 col-md-3 col-lg-3">
                            {{ f.floatingLabel('sbhba-n', 'Basal/squamous-cell skin cancer') }}
                        </div>
                        <div class="col-sm-6 col-md-3 col-lg-2">
                            <div class="form-group">
                                {{ f.inlineRadioNYQ("sbhba") }}
                            </div>
                        </div>
                        <div id="sbhba-container" style="display: none;">
                            <div class="form-group col-sm-4 col-md-2">
                                <label class="control-label required" for="sbhbadt">Year</label>
                                {{ f.yearpicker("sbhbadt", true, true) }}
                            </div>
                        </div>
                    </div>
                    <hr class="visible-xs-block visible-sm-block"/>

                    <div class="row">
                        <div class="col-sm-6 col-md-3 col-lg-3">
                            {{ f.floatingLabel('sbhle-n', 'Leukemia') }}
                        </div>
                        <div class="col-sm-6 col-md-3 col-lg-2">
                            <div class="form-group">
                                {{ f.inlineRadioNYQ("sbhle") }}
                            </div>
                        </div>
                        <div id="sbhle-container" style="display: none;">
                            <div class="form-group col-sm-4 col-md-2">
                                <label class="control-label required" for="sbhledt">Year</label>
                                {{ f.yearpicker("sbhledt", true, true) }}
                            </div>
                        </div>
                    </div>
                    <hr class="visible-xs-block visible-sm-block"/>

                    <div class="row">
                        <div class="col-sm-6 col-md-3 col-lg-3">
                            {{ f.floatingLabel('sbhly-n', 'Lymphoma') }}
                        </div>
                        <div class="col-sm-6 col-md-3 col-lg-2">
                            <div class="form-group">
                                {{ f.inlineRadioNYQ("sbhly") }}
                            </div>
                        </div>
                        <div id="sbhly-container" style="display: none;">
                            <div class="form-group col-sm-4 col-md-2">
                                <label class="control-label required" for="sbhlydt">Year</label>
                                {{ f.yearpicker("sbhlydt", true, true) }}
                            </div>
                        </div>
                    </div>
                    <hr class="visible-xs-block visible-sm-block"/>

                    <div class="row">
                        <div class="col-sm-6 col-md-3 col-lg-3">
                            {{ f.floatingLabel('sbaoc', 'Any other cancer(s)') }}
                        </div>
                        <div class="col-sm-6 col-md-3 col-lg-2">
                            <div class="form-group">
                                {{ f.inlineRadioNYQ("sbaoc") }}
                            </div>
                        </div>
                        <div id="sbaoc-container" style="display: none;">
                            <div class="form-group col-sm-4 col-md-2">
                                <label class="control-label required" for="sbaocsp">Specify</label>
                                <input type="text" name="sbaocsp" class="form-control input-sm" required="required"/>
                            </div>

                            <div class="form-group col-sm-4 col-md-2">
                                <label class="control-label required" for="sbaocyr">Year</label>
                                {{ f.yearpicker("sbaocyr", true, true) }}
                            </div>
                            <div class="form-group col-sm-4 col-md-2" style="vertical-align: top;">
                                <label class="control-label required" for="sbaocps">Primary site</label>
                                <input class="form-control input-sm" type="text" name="sbaocps"
                                       id="sbaocps" required="required">
                            </div>
                        </div>
                    </div>
                    <hr class="visible-xs-block visible-sm-block"/>
                </div>
            </div>

            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Pulmonary problems</h3>
                </div>
                <div class="panel-body">
                    <div class="row">
                        <div class="col-sm-6 col-md-3 col-lg-3">
                            {{ f.floatingLabel('sbmpa-n', 'Asthma') }}
                        </div>
                        <div class="col-sm-6 col-md-3 col-lg-2">
                            <div class="form-group">
                                {{ f.inlineRadioNYQ("sbmpa") }}
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-6 col-lg-7" id="sbmpa-container" style="display: none;">
                            <div class="form-group">
                                <label for="sbmpat-n" class="required">Under current treatment?</label><br/>
                                {{ f.inlineRadio("sbmpat","sbmpat-n","n", "No", true) }}
                                {{ f.inlineRadio("sbmpat","sbmpat-y","y", "Yes") }}
                            </div>
                        </div>
                    </div>
                    <hr class="visible-xs-block visible-sm-block"/>

                    <div class="row">
                        <div class="col-sm-6 col-md-3 col-lg-3">
                            {{ f.floatingLabel('sbmpc-n', 'COPD/Emphysema/Chronic bronchitis') }}
                        </div>
                        <div class="col-sm-6 col-md-3 col-lg-2">
                            <div class="form-group">
                                {{ f.inlineRadioNYQ("sbmpc") }}
                            </div>
                        </div>
                        <div class="col-sm-4 col-md-2" id="sbmpc-container" style="display: none;">
                            <div class="form-group">
                                <label class="control-label required" for="sbmpcw">Year</label>
                                {{ f.yearpicker("sbmpcw", true, true) }}
                            </div>
                        </div>
                    </div>
                    <hr class="visible-xs-block visible-sm-block"/>

                    <div class="row">
                        <div class="col-sm-6 col-md-3 col-lg-3">
                            {{ f.floatingLabel('sbmpn-n', 'Childhood pneumonia') }}
                        </div>
                        <div class="col-sm-6 col-md-3 col-lg-2">
                            <div class="form-group">
                                {{ f.inlineRadioNYQ("sbmpn") }}
                            </div>
                        </div>
                    </div>
                    <hr class="visible-xs-block visible-sm-block"/>
                </div>
            </div>

            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Diabetes</h3>
                </div>
                <div class="panel-body">
                    <div class="row">
                        <div class="col-sm-6 col-md-3 col-lg-3">
                            {{ f.floatingLabel('sbmpd-n', 'Diabetes') }}
                        </div>
                        <div class="col-sm-6 col-md-3 col-lg-2">
                            <div class="form-group">
                                {{ f.inlineRadioNYQ("sbmpd") }}
                            </div>
                        </div>
                        <div id="sbmpd-container" style="display: none;">
                            <div class=" col-sm-4 col-md-2 form-group">
                                <label class="control-label required" for="sbmpdw">Starting at what age?</label>
                                <input class="form-control input-sm numeric" type="text" name="sbmpdw"
                                       id="sbmpdw" size="4" maxlength="4">
                            </div>

                            <div class=" col-sm-4 col-md-2 form-group">
                                <label class="control-label required" for="sbmpdt-n">Treated?</label><br/>
                                {{ f.inlineRadio("sbmpdt", "sbmpdt-n", "n", "No", true) }}
                                {{ f.inlineRadio("sbmpdt", "sbmpdt-y", "y", "Yes") }}
                            </div>

                        </div>
                    </div>
                    <hr class="visible-xs-block visible-sm-block"/>
                </div>
            </div>

            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Cardiac Diseases</h3>
                </div>
                <div class="panel-body">
                    <div class="row">
                        <div class="col-sm-6 col-md-3 col-lg-3">
                            {{ f.floatingLabel('sbmpmi-n', 'Myocardial Infarction (MI)') }}
                        </div>
                        <div class="col-sm-6 col-md-3 col-lg-2">
                            <div class="form-group">
                                {{ f.inlineRadioNYQ("sbmpmi") }}
                            </div>
                        </div>
                        <div id="sbmpmi-container" style="display: none;">
                            <div class="form-group col-sm-4 col-md-2">
                                <label class="control-label required" for="sbmpmid">Year</label>
                                {{ f.yearpicker("sbmpmid", true, true) }}
                            </div>
                            <div class="form-group col-sm-4 col-md-2">
                                <label class="control-label" for="sbmpmiw">Where Treated</label>
                                <input class="form-control input-sm" type="text" name="sbmpmiw" id="sbmpmiw"
                                       required="required">
                            </div>
                        </div>
                    </div>
                    <hr class="visible-xs-block visible-sm-block"/>

                    <div class="row">
                        <div class="col-sm-6 col-md-3 col-lg-3">
                            {{ f.floatingLabel('sbmpas-n', 'Angiostents') }}
                        </div>
                        <div class="col-sm-6 col-md-3 col-lg-2">
                            <div class="form-group">
                                {{ f.inlineRadioNYQ("sbmpas") }}
                            </div>
                        </div>
                        <div id="sbmpas-container" style="display: none;">
                            <div class="form-group col-sm-4 col-md-2">
                                <label class="control-label required" for="sbmpasw">Year</label>
                                {{ f.yearpicker("sbmpasw", true, true) }}
                            </div>
                            <div class="form-group col-sm-4 col-md-2" style="vertical-align: top;">
                                <label class="control-label required" for="sbmpast">Where Treated</label>
                                <input class="form-control input-sm" type="text" name="sbmpast" id="sbmpast"
                                       required="required">
                            </div>
                        </div>
                    </div>
                    <hr class="visible-xs-block visible-sm-block"/>

                    <div class="row">
                        <div class="col-sm-6 col-md-3 col-lg-3">
                            {{ f.floatingLabel('sbmpcabg-n', '<abbr title="coronary artery bypass grafting">CABG<abbr>') }}
                        </div>
                        <div class="col-sm-6 col-md-3 col-lg-2">
                            <div class="form-group">
                                {{ f.inlineRadioNYQ("sbmpcabg") }}
                            </div>
                        </div>
                        <div id="sbmpcabg-container" style="display: none;">
                            <div class="form-group col-sm-4 col-md-2">
                                <label class="control-label required" for="sbmpcaby">Year</label>
                                {{ f.yearpicker("sbmpcaby", true, true) }}
                            </div>
                            <div class="form-group col-sm-4 col-md-2" style="vertical-align: top;">
                                <label class="control-label required" for="sbmpcawt">Where Treated</label>
                                <input class="form-control input-sm" type="text" name="sbmpcawt" id="sbmpcawt"
                                       required="required">
                            </div>
                        </div>
                    </div>
                    <hr class="visible-xs-block visible-sm-block"/>

                    <div class="row">
                        <div class="col-sm-6 col-md-3 col-lg-3">
                            {{ f.floatingLabel('sbmpangi-n', 'Angina') }}
                        </div>
                        <div class="col-sm-6 col-md-3 col-lg-2">
                            <div class="form-group">
                                {{ f.inlineRadioNYQ("sbmpangi") }}
                            </div>
                        </div>
                        <div id="sbmpangi-container" style="display: none;">
                            <div class="form-group col-sm-4 col-md-2">
                                <label class="control-label required" for="sbmpangy">Year</label>
                                {{ f.yearpicker("sbmpangy", true, true) }}
                            </div>
                            <div class="form-group col-sm-4 col-md-2" style="vertical-align: top;">
                                <label class="control-label required" for="sbmpanwt">Where Treated</label>
                                <input class="form-control input-sm" type="text" name="sbmpanwt" id="sbmpanwt"
                                       required="required">
                            </div>
                        </div>
                    </div>
                    <hr class="visible-xs-block visible-sm-block"/>

                    <div class="row">
                        <div class="col-sm-6 col-md-3 col-lg-3">
                            {{ f.floatingLabel('sbmphf-n', 'Heart Failure') }}
                        </div>
                        <div class="col-sm-6 col-md-3 col-lg-2">
                            <div class="form-group">
                                {{ f.inlineRadioNYQ("sbmphf") }}
                            </div>
                        </div>
                        <div id="sbmphf-container" style="display: none;">
                            <div class="form-group col-sm-4 col-md-2">
                                <label class="control-label required" for="sbmphfy">Year</label>
                                {{ f.yearpicker("sbmphfy", true, true) }}
                            </div>
                            <div class="form-group col-sm-4 col-md-2" style="vertical-align: top;">
                                <label class="control-label required" for="sbmphfwt">Where Treated</label>
                                <input class="form-control input-sm" type="text" name="sbmphfwt" id="sbmphfwt"
                                       required="required">
                            </div>
                        </div>
                    </div>
                    <hr class="visible-xs-block visible-sm-block"/>

                    <div class="row">
                        <div class="col-sm-6 col-md-3 col-lg-3">
                            {{ f.floatingLabel('sbmphc-n', 'High cholesterol') }}
                        </div>
                        <div class="col-sm-6 col-md-3 col-lg-2">
                            <div class="form-group">
                                {{ f.inlineRadioNYQ("sbmphc") }}
                            </div>
                        </div>
                    </div>
                    <hr class="visible-xs-block visible-sm-block"/>

                </div>
            </div>

            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Vascular Diseases</h3>
                </div>
                <div class="panel-body">
                    <div class="row">
                        <div class="col-sm-6 col-md-3 col-lg-3">
                            {{ f.floatingLabel('sbmps-n', 'Stroke') }}
                        </div>
                        <div class="col-sm-6 col-md-3 col-lg-2">
                            <div class="form-group">
                                {{ f.inlineRadioNYQ("sbmps") }}
                            </div>
                        </div>
                        <div id="sbmps-container" style="display: none;">
                            <div class="form-group col-sm-4 col-md-2">
                                <label class="control-label required" for="sbmpsd">Year</label>
                                {{ f.yearpicker("sbmpsd", true, true) }}
                            </div>
                        </div>
                    </div>
                    <hr class="visible-xs-block visible-sm-block"/>

                    <div class="row">
                        <div class="col-sm-6 col-md-3 col-lg-3">
                            {{ f.floatingLabel('sbmppv-n', 'Peripheral vascular disease') }}
                        </div>
                        <div class="col-sm-6 col-md-3 col-lg-2">
                            <div class="form-group">
                                {{ f.inlineRadioNYQ("sbmppv") }}
                            </div>
                        </div>
                        <div id="sbmppv-container" style="display: none;">
                            <div class="form-group  col-sm-4 col-md-2">
                                <label class="control-label required" for="sbmppvd">Year</label>
                                {{ f.yearpicker("sbmppvd", true, true) }}
                            </div>
                        </div>
                    </div>
                    <hr class="visible-xs-block visible-sm-block"/>

                    <div class="row">
                        <div class="col-sm-6 col-md-3 col-lg-3">
                            {{ f.floatingLabel('sbmpht-n', 'Hypertension') }}
                        </div>
                        <div class="col-sm-6 col-md-3 col-lg-2">
                            <div class="form-group">
                                {{ f.inlineRadioNYQ("sbmpht") }}
                            </div>
                        </div>
                        <div id="sbmpht-container" style="display: none;">
                            <div class="form-group col-sm-4 col-md-2" style="vertical-align: top;">
                                <label class="form-check-inline required" for="sbmphtt-n">Treated?</label><br/>
                                {{ f.inlineRadio("sbmphtt", "sbmphtt-n", "n", "No", true) }}
                                {{ f.inlineRadio("sbmphtt", "sbmphtt-y", "y", "Yes") }}
                            </div>
                            <div class="form-group col-sm-4 col-md-2" style="vertical-align: top;">
                                <label class="control-label required" for="sbmphtsw">Year</label>
                                {{ f.yearpicker("sbmphtsw", true, true) }}
                            </div>
                            <div class="form-group col-sm-4 col-md-2" style="vertical-align: top;">
                                <label class="control-label numeric" for="sbmphthv">Highest Value</label>
                                <input class="form-control input-sm numeric decimalformat" type="text" name="sbmphthv"
                                       id="sbmphthv">
                            </div>

                        </div>
                    </div>
                    <hr class="visible-xs-block visible-sm-block"/>

                </div>
            </div>

            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Other Diseases</h3>
                </div>
                <div class="panel-body">
                    <div class="row">
                        <div class="col-sm-6 col-md-3 col-lg-3">
                            {{ f.floatingLabel('sbmpct-n', 'Connective tissue diseases') }}
                        </div>
                        <div class="col-sm-6 col-md-3 col-lg-2">
                            <div class="form-group">
                                {{ f.inlineRadioNYQ("sbmpct") }}
                            </div>
                        </div>
                        <div id="sbmpct-container" style="display: none;">
                            <div class="form-group col-sm-12 col-md-6 col-lg-7">
                                <label class="control-label required" for="sbmpctsp">Specify</label>
                                <input type="text" name="sbmpctsp" id="sbmpctsp" class="form-control input-sm"
                                       required="required"/>
                            </div>
                        </div>

                    </div>
                    <hr class="visible-xs-block visible-sm-block"/>

                    <div class="row">
                        <div class="col-sm-6 col-md-3 col-lg-3">
                            {{ f.floatingLabel('sbmpulce-n', 'Ulcer') }}
                        </div>
                        <div class="col-sm-6 col-md-3 col-lg-2">
                            <div class="form-group">
                                {{ f.inlineRadioNYQ("sbmpulce") }}
                            </div>
                        </div>
                    </div>
                    <hr class="visible-xs-block visible-sm-block"/>

                    <div class="row">
                        <div class="col-sm-6 col-md-3 col-lg-3">
                            {{ f.floatingLabel('sbmpld-n', 'Liver disease') }}
                        </div>
                        <div class="col-sm-6 col-md-3 col-lg-2">
                            <div class="form-group">
                                {{ f.inlineRadioNYQ("sbmpld") }}
                            </div>
                        </div>
                    </div>
                    <hr class="visible-xs-block visible-sm-block"/>

                    <div class="row">
                        <div class="col-sm-6 col-md-3 col-lg-3">
                            {{ f.floatingLabel('sbmprd-n', 'Renal disease') }}
                        </div>
                        <div class="col-sm-6 col-md-3 col-lg-2">
                            <div class="form-group">
                                {{ f.inlineRadioNYQ("sbmprd") }}
                            </div>
                        </div>
                    </div>
                    <hr class="visible-xs-block visible-sm-block"/>

                    <div class="row">
                        <div class="col-sm-6 col-md-3 col-lg-3">
                            {{ f.floatingLabel('sbmpoth-n', 'Other') }}
                        </div>
                        <div class="col-sm-6 col-md-3 col-lg-2">
                            <div class="form-group">
                                {{ f.inlineRadioNYQ("sbmpoth") }}
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-6 col-lg-7" id="sbmpoth-container" style="display: none;">
                            <div class="form-group">
                                <label class="control-label required" for="sbmpoth-n">Specify</label><br/>
                                <input class="form-control" type="text" name="sbmpod" id="sbmpod"
                                       required="required">
                            </div>
                        </div>
                    </div>
                    <hr class="visible-xs-block visible-sm-block"/>


                </div>
            </div>

            <div class="row">
                <div class="col-md-12">
                    <div class="form-group">
                        <label for="sbcmnt">Comments</label>
                        <textarea name="sbcmnt" id="sbcmnt" class="form-control"></textarea>
                    </div>
                </div>
            </div>

            <div class="pull-left">
                <input type="hidden" name="samistatus" value=""/>
                <button type="submit" class="btn btn-default" id="save-for-later-button">Save for Later</button>
                <button type="submit" class="btn btn-primary" id="submit-button">Submit</button>
            </div>
            <div class="pull-right">
                <a id="delete-form" class="btn btn-danger"><span class="glyphicon glyphicon-trash"></span>Delete</a>
            </div>
        </form>
    </div>

    {{ f.deleteFormModal("background.html", mockup, formMethod) }}

{% endblock %}

{% block script %}
    <script language="JavaScript">

        function createFormValidator() {

            const $form = $('#main-form');
            const multiInputValidators = ['sbfcf', 'sbfcm', 'sbfcs'];
            const thisYear = VAPALS.todaysYear();
            const minYear = thisYear - 100;
            const yearValidationMessage = 'Must be between ' + minYear + ' and ' + thisYear;
            $form.formValidation({
                    fields: {
                        //top section
                        sbahas: {validators: {notEmpty: {message: 'Other work is required'}}},
                        sbwcos: {validators: {notEmpty: {message: 'Other symptom is required'}}},
                        sbahcl: {validators: {notEmpty: {message: 'CT location is required'}}},

                        //Cancers
                        // - family history
                        sbfcf: {validators: {notEmpty: {message: 'Father\'s history is required'}}},
                        sbfcm: {validators: {notEmpty: {message: 'Mother\'s history is required'}}},
                        sbfcs: {validators: {notEmpty: {message: 'Sibling\'s history is required'}}},
                        // - lung cancer
                        sbhlcdt: {
                            validators: {
                                notEmpty: {message: 'Year is required'},
                                between: {message: yearValidationMessage, min: minYear, max: thisYear}
                            }
                        },
                        // - melanima
                        sbhmedt: {
                            validators: {
                                notEmpty: {message: 'Year is required'},
                                between: {message: yearValidationMessage, min: minYear, max: thisYear}
                            }
                        },
                        // - Basal/squamous-cell skin
                        sbhbadt: {
                            validators: {
                                notEmpty: {message: 'Year is required'},
                                between: {message: yearValidationMessage, min: minYear, max: thisYear}
                            }
                        },
                        // - Leukemia
                        sbhledt: {
                            validators: {
                                notEmpty: {message: 'Year is required'},
                                between: {message: yearValidationMessage, min: minYear, max: thisYear}
                            }
                        },
                        // - Lymphoma
                        sbhlydt: {
                            validators: {
                                notEmpty: {message: 'Year is required'},
                                between: {message: yearValidationMessage, min: minYear, max: thisYear}
                            }
                        },
                        // - Other cancers
                        sbaocsp: {validators: {notEmpty: {message: 'Other cancers(s) is required'}}},
                        sbaocyr: {
                            validators: {
                                notEmpty: {message: 'Year is required'},
                                between: {message: yearValidationMessage, min: minYear, max: thisYear}
                            }
                        },
                        sbaocps: {validators: {notEmpty: {message: 'Primary site is required'}}},

                        //Pulmonary
                        // - asthma
                        sbmpat: {validators: {notEmpty: {message: 'Current treatment is required'}}},
                        // - COPD
                        sbmpcw: {
                            validators: {
                                notEmpty: {message: 'Year is required'},
                                between: {message: yearValidationMessage, min: minYear, max: thisYear}
                            }
                        },

                        //Diabetes
                        sbmpdw: {
                            validators: {
                                notEmpty: {message: 'Age is required'},
                                between: {message: 'Must be between 1 and 100', min: 1, max: 100}
                            }
                        },
                        sbmpdt: {validators: {notEmpty: {message: 'Treated is required'}}},

                        //Cardiac
                        // - MI
                        sbmpmid: {
                            validators: {
                                notEmpty: {message: 'Year is required'},
                                between: {message: yearValidationMessage, min: minYear, max: thisYear}
                            }
                        },
                        sbmpmiw: {validators: {notEmpty: {message: 'Where treated is required'}}},
                        // - Angiostents
                        sbmpasw: {
                            validators: {
                                notEmpty: {message: 'Year is required'},
                                between: {message: yearValidationMessage, min: minYear, max: thisYear}
                            }
                        },
                        sbmpast: {validators: {notEmpty: {message: 'Where treated is required'}}},
                        // - CABG
                        sbmpcaby: {
                            validators: {
                                notEmpty: {message: 'Year is required'},
                                between: {message: yearValidationMessage, min: minYear, max: thisYear}
                            }
                        },
                        sbmpcawt: {validators: {notEmpty: {message: 'Where treated is required'}}},
                        // - Angina
                        sbmpangy: {
                            validators: {
                                notEmpty: {message: 'Year is required'},
                                between: {message: yearValidationMessage, min: minYear, max: thisYear}
                            }
                        },
                        sbmpanwt: {validators: {notEmpty: {message: 'Where treated is required'}}},
                        // - heart failure
                        sbmphfy: {
                            validators: {
                                notEmpty: {message: 'Year is required'},
                                between: {message: yearValidationMessage, min: minYear, max: thisYear}
                            }
                        },
                        sbmphfwt: {validators: {notEmpty: {message: 'Where treated is required'}}},

                        //Vascular
                        // - stroke
                        sbmpsd: {
                            validators: {
                                notEmpty: {message: 'Year is required'},
                                between: {message: yearValidationMessage, min: minYear, max: thisYear}
                            }
                        },
                        // - peripheral vascular disease
                        sbmppvd: {
                            validators: {
                                notEmpty: {message: 'Year is required'},
                                between: {message: yearValidationMessage, min: minYear, max: thisYear}
                            }
                        },
                        // - hypertension
                        sbmphtt: {validators: {notEmpty: {message: 'Treated is required'}}},
                        sbmphtsw: {
                            validators: {
                                notEmpty: {message: 'Year is required'},
                                between: {message: yearValidationMessage, min: minYear, max: thisYear}
                            }
                        },
                        sbmphthv: {
                            validators: {
                                numeric: {message: 'Must be a number'},
                                greaterThan: {min: 0, message: 'Value must be greater than 0'}
                            }
                        },

                        //Other diseases
                        // - connective tissue
                        sbmpctsp: {validators: {notEmpty: {message: 'Connective tissue is required'}}},
                        sbmpod: {validators: {notEmpty: {message: 'Other disease is required'}}},

                    },
                    plugins: {
                        trigger: new FormValidation.plugins.Trigger(),
                        bootstrap3: new FormValidation.plugins.Bootstrap3(),
                        submitButton: new FormValidation.plugins.SubmitButton({selector: "#submit-button"}),
                        defaultSubmit: new FormValidation.plugins.DefaultSubmit(),
                        excluded: new FormValidation.plugins.Excluded(), //disable validators on hidden, disabled fields
                        icon: new FormValidation.plugins.Icon({
                            valid: '',
                            invalid: 'glyphicon glyphicon-remove',
                            validating: 'glyphicon glyphicon-refresh',
                            onPlaced: function (e) {
                                if (multiInputValidators.indexOf(e.field) > -1) {
                                    $("#" + e.element.id).closest(".form-group").append(e.iconElement);
                                }
                            },
                        })
                    }
                }
            );

            const fv = $form.data('formValidation');
            fv.on('core.form.invalid', VAPALS.autoScrollToErrorField);
            fv.on('core.element.validated', VAPALS.hideSuccessFormatting);

            return fv;
        }

        $(function () {

            createFormValidator();

            //hook for calculating Pulmonary function test percentage (FFR)
            $("#sbfev1, #sbfvc").on('change', function () {
                const fev1 = $("#sbfev1").val();
                const fvc = $("#sbfvc").val();
                const ffr = VAPALS.calculatePulmonaryFunction(fev1, fvc);
                if (ffr > 0) {
                    $("#sbffr").val(ffr);
                    $("#ffr-value").text(ffr);
                    $("#ffr-message").show();
                } else {
                    $("#sbffr").val("");
                    $("#ffr-message").hide();
                }

            }).first().trigger('change');

            //conditionally enabled fields
            const uncheckableRadioFieldNames = Array(
                "sblcs",  //51 lung cancer indicative
                "sbahpft", //103 pulmonary function test
                "sbfc", "sbhlc", "sbhme", "sbhba", "sbhle", "sbhly", "sbaoc",//cancers
                "sbmpa", "sbmpc", //pulmonary
                "sbmpd", //diabetes
                "sbmpmi", "sbmpas", "sbmpcabg", "sbmpangi", "sbmphf", //cardiac
                "sbmps", "sbmppv", "sbmpht", //vascular
                "sbmpct", "sbmpoth", //Other disease
            );

            $.each(uncheckableRadioFieldNames, function (idx, name) {
                $("[name=" + name + "]").conditionallyDisplay({enable: "#" + name + "-container"});
                uncheckableRadio("[name='" + name + "']", "div.form-group");
            });


            $("#sbwco").conditionallyDisplay({sourceValues: "o", enable: "#sbwcos"});
            $("[name=sbact]").conditionallyDisplay({
                sourceValues: function (actualValue) {
                    return actualValue !== '-' && actualValue !== 'e';
                }, enable: "#sbact-container"
            });

            $("#sbahaoo").conditionallyDisplay({sourceValues: "o", enable: "#sbahas"});

        });

    </script>
{% endblock %}