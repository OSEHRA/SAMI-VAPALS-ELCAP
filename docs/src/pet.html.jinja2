{% extends 'layout.jinja2' %}
{% import 'forms.jinja2' as f %}
{% block title %}{{ title | escape }}{% endblock %}

{% block body %}
    <div class="container-fluid" style="max-width:1550px">
        <h1>
            Sample, Sammy G
            <small class="text-muted" title="Study ID">ST0001</small>
        </h1>
        <h2>{{ title | escape }}
            <small class="text-muted" title="Medical Record Number">1234567890</small>
        </h2>

        <hr/>
        <form action="{{ formPage+".html" if mockup else "/vapals" }}" method="{{ formMethod }}"
              class="validated"
              data-fv-icon-valid="glyphicon glyphicon-ok"
              data-fv-icon-invalid="glyphicon glyphicon-remove"
              data-fv-icon-validating="glyphicon glyphicon-refresh"
              data-fv-button-selector="#submit-button">

            <input type="hidden" name="samiroute" value="postform"/>
            <input type="hidden" name="studyid" value="@@SID@@"/>
            <input type="hidden" name="form" value="@@FORMKEY@@"/>

            <div class="row">
                <div class="col-sm-4 col-md-3 form-group">
                    <label class="control-label" for="bxdos">Study Date</label>
                    {{ f.datepicker("ptdos", true, "Study Date is required") }}
                </div>
            </div>

            <div class="row">
                <div class="col-sm-6 form-group">
                    <label for="ptrad">Radiologist</label>
                    <input type="text" class="form-control" id="ptrad" name="ptrad" required="required"/>
                </div>
                <div class="col-sm-4 col-md-3 col-lg-2 form-group">
                    <label for="ptradnpi">Radiologist NPI</label>
                    <input type="text" class="form-control" id="ptradnpi" name="ptradnpi"/>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 form-group">
                    {{ f.floatingLabel("ptofr-n", "PET Scan Performed at Outside Institution") }}
                </div>
                <div class="col-sm-3 form-group">
                    {{ f.inlineRadio("ptofr", "ptofr-n", "n", "no") }}
                    {{ f.inlineRadio("ptofr", "ptofr-y", "yes", "yes") }}
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 form-group">
                    {{ f.floatingLabel("sidoe", "Date of Baseline CT") }}
                </div>
                <div class="col-sm-3 form-group">
                    {{ f.datepicker("sidoe", true, "Baseline CT date is required") }}
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 form-group">
                    {{ f.floatingLabel("cedos", "Date of Most Recent Comparative Study") }}
                </div>
                <div class="col-sm-3 form-group">
                    {{ f.datepicker("cedos", true, "Date is required") }}
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 form-group">
                    {{ f.floatingLabel("ceanod-n", "Are there any nodules noted in the CT scan?") }}
                </div>
                <div class="col-sm-3 form-group">
                    {{ f.inlineRadio("ceanod", "ceanod-n", "n", "no") }}
                    {{ f.inlineRadio("ceanod", "ceanod-y", "yes", "yes") }}
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 form-group">
                    {{ f.floatingLabel("cenncnlt-n", "Are non-calcified nodules noted, all less than 6 mm?") }}
                </div>
                <div class="col-sm-3 form-group">
                    {{ f.inlineRadio("cenncnlt", "cenncnlt-n", "n", "no") }}
                    {{ f.inlineRadio("cenncnlt", "cenncnlt-y", "yes", "yes") }}
                </div>
            </div>

            <div class="alert alert-info">
                <strong>List any nodule(s) of concern* in the table below. If baseline >= 6 mm or if repeat, >= 3
                    mm</strong>
                <BR>
                Enter the Nodule Uptake values and update the Nodule Status to reflect the results of the PET
                study, and update the neccesary actions for each nodule, as indicated. Enter any details given in
                the PET report in the PET Details field.
                <BR>Update the Follow-up section.
            </div>

            <div class="table-responsive">
                <table class="table">
                    <thead>
                    <tr>
                        <th>Nodule ID</th>
                        <th>Nodule 1</th>
                        <th>
                            Additional Nodules
                            <select name="cefctn" id="cefctn">
                                <option value="2"> Nodule 2
                                <option value="3"> Nodule 3
                                <option value="4"> Nodule 4
                                <option value="5"> Nodule 5
                            </select>
                        </th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td><label for="cect1ch">Is it new?</label></td>
                        <td>
                            <select name="cect1ch" id="cect1ch" class="form-control">
                                <option value="-"> -
                                <option value="n"> newly seen
                                <option value="pn"> prev seen, no change
                                <option value="pd"> prev seen, slight decr
                                <option value="pe"> prev seen, marked decr
                                <option value="pi"> prev seen, slight incr
                                <option value="pj"> prev seen, marked incr
                                <option value="po"> prev seen, obscured
                                <option value="pw"> prev seen, resolved
                                <option value="px"> prev seen, not a nodule
                                <option value="pr"> prev seen, resected
                                <option value="rn"> retrospect, no chg
                                <option value="rd"> retrospect, decrease
                                <option value="ri"> retrospect, slight incr
                                <option value="rj"> retrospect, marked incr
                                <option value="pk"> not in outside report
                                <option value="pv"> not included in scan
                            </select>
                        </td>
                        <td>
                            <select name="cect0ch" id="cect0ch" class="form-control">
                                <option value="-"> -
                                <option value="n"> newly seen
                                <option value="pn"> prev seen, no change
                                <option value="pd"> prev seen, slight decr
                                <option value="pe"> prev seen, marked decr
                                <option value="pi"> prev seen, slight incr
                                <option value="pj"> prev seen, marked incr
                                <option value="po"> prev seen, obscured
                                <option value="pw"> prev seen, resolved
                                <option value="px"> prev seen, not a nodule
                                <option value="pr"> prev seen, resected
                                <option value="rn"> retrospect, no chg
                                <option value="rd"> retrospect, decrease
                                <option value="ri"> retrospect, slight incr
                                <option value="rj"> retrospect, marked incr
                                <option value="pk"> not in outside report
                                <option value="pv"> not included in scan
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td><label for="cect1ll">Most Likely Location</label></td>
                        <td>
                            <select name="cect1ll" id="cect1ll" class="form-control">
                                <option value="-"> -
                                <option value="end"> Endobr
                                <option value="lul"> LUL
                                <option value="lll"> LLL
                                <option value="rul"> RUL
                                <option value="rml"> RML
                                <option value="rll"> RLL
                            </select>
                        </td>
                        <td>
                            <select name="cect0ll" id="cect0ll" class="form-control">
                                <option value="-"> -
                                <option value="end"> Endobr
                                <option value="lul"> LUL
                                <option value="lll"> LLL
                                <option value="rul"> RUL
                                <option value="rml"> RML
                                <option value="rll"> RLL
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label for="cect1up">Maximum Nodule Uptake (SUV)</label>
                        </td>
                        <td>
                            <input type=text name="cect1up" class="form-control numeric">
                        </td>
                        <td>
                            <input type=text name="cect0up" class="form-control numeric">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label for="cect1st">Nodule Status</label>
                        </td>
                        <td>
                            <select name="cect1st" id="cect1st" class="form-control">
                                <option value="-"> -
                                <option value="un"> unknown
                                <option value="bc"> benign (Ca++)
                                <option value="pc"> prob benign, prob Ca++
                                <option value="re"> resolved
                                <option value="rg"> resolving
                                <option value="tn"> no change - 2 yrs
                                <option value="pp"> PET - positive
                                <option value="pn"> PET - negative
                                <option value="pi"> PET - indeterminate
                                <option value="ub"> Biopsy - unknown
                                <option value="bb"> Biopsy - benign
                                <option value="mb"> Biopsy - malignant
                                <option value="ab"> Biopsy - atyp bronch prolif
                                <option value="om"> Biopsy - metastatic
                                <option value="mr"> Resected - malignant
                                <option value="br"> Resected - benign
                            </select>
                        </td>
                        <td>
                            <select name="cect0st" id="cect0st" class="form-control">
                                <option value="-"> -
                                <option value="un"> unknown
                                <option value="bc"> benign (Ca++)
                                <option value="pc"> prob benign, prob Ca++
                                <option value="re"> resolved
                                <option value="rg"> resolving
                                <option value="tn"> no change - 2 yrs
                                <option value="pp"> PET - positive
                                <option value="pn"> PET - negative
                                <option value="pi"> PET - indeterminate
                                <option value="ub"> Biopsy - unknown
                                <option value="bb"> Biopsy - benign
                                <option value="mb"> Biopsy - malignant
                                <option value="ab"> Biopsy - atyp bronch prolif
                                <option value="om"> Biopsy - metastatic
                                <option value="mr"> Resected - malignant
                                <option value="br"> Resected - benign
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td><label for="cect1pd">Pathologic Diagnosis</label></td>
                        <td>
                            <select name="cect1pd" id="cect1pd" class="form-control">
                                <option value="-"> -For Pathology Use Only-
                                <option value="aa"> AAH
                                <option value="ap"> atyp bronch prolif
                                <option value="ba"> BAC
                                <option value="ns"> unspec. non-small cell
                                <option value="ad"> adenocarcinoma
                                <option value="as"> adenosquamous
                                <option value="la"> large cell
                                <option value="sq"> squamous cell
                                <option value="sm"> small cell
                                <option value="ct"> carcinoid - typical
                                <option value="ca"> carcinoid - atypical
                                <option value="be"> not malignant
                                <option value="bs"> benign specific
                                <option value="os"> other (specify)
                            </select>
                        </td>
                        <td>
                            <select name="cect0pd" id="cect0pd" class="form-control">
                                <option value="-"> -For Pathology Use Only-
                                <option value="aa"> AAH
                                <option value="ap"> atyp bronch prolif
                                <option value="ba"> BAC
                                <option value="ns"> unspec. non-small cell
                                <option value="ad"> adenocarcinoma
                                <option value="as"> adenosquamous
                                <option value="la"> large cell
                                <option value="sq"> squamous cell
                                <option value="sm"> small cell
                                <option value="ct"> carcinoid - typical
                                <option value="ca"> carcinoid - atypical
                                <option value="be"> not malignant
                                <option value="bs"> benign specific
                                <option value="os"> other (specify)
                            </select>
                        </td>
                    </tr>
                    </tbody>

                </table>
            </div>

            <div class="row">
                <div class="col-md-4 form-group">
                    {{ f.floatingLabel("ceinod", "Indicate the index nodule driving follow up:") }}
                </div>
                <div class="col-sm-3 form-group">
                    <select name="ceinod" id="ceinod" class="form-control">
                        <option value="-"> -
                        <option value="1"> 1
                        <option value="2"> 2
                        <option value="3"> 3
                        <option value="4"> 4
                        <option value="5"> 5
                    </select>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 form-group">
                    {{ f.floatingLabel("celrad", "LungRADS category") }}
                </div>
                <div class="col-sm-3 form-group">
                    <select name="celrad" id="celrad" class="form-control">
                        <option value="-"> -
                        <option value="0"> 0
                        <option value="1"> 1
                        <option value="2"> 2
                        <option value="3"> 3
                        <option value="4A"> 4A
                        <option value="4B"> 4B
                        <option value="4X"> 4X
                    </select>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 form-group">
                    {{ f.floatingLabel("celrads", "LungRADS modifier") }}
                </div>
                <div class="col-sm-3 form-group">
                    {{ f.checkbox("celrads", "S", "S") }}
                    {{ f.checkbox("celradc", "C", "C") }}
                </div>
            </div>

            <div class="row">
                <div class="form-group col-sm-12">
                    <label for="ptpdt">PET Details - Lung and nodules</label>
                    <textarea name="ptpdt" id="ptpdt" class="form-control"></textarea>
                </div>
            </div>

            <div class="row">
                <div class="form-group col-sm-12">
                    <label for="ptpdtln">PET Details - Lymph nodes</label>
                    <textarea name="ptpdtln" id="ptpdtln" class="form-control"></textarea>
                </div>
            </div>


            <div class="row">
                <div class="col-md-4 form-group">
                    {{ f.floatingLabel("ceaf-n", "Other clinically significant ancillary finding?") }}
                </div>
                <div class="col-sm-8 form-group">
                    {{ f.inlineRadio("ceaf", "ceaf-n", "n", "no") }}
                    {{ f.inlineRadio("ceaf", "ceaf-y", "yes", "yes") }}
                    {% set r =  [1,2] %}
                    {% for i in r %}
                        <div class="row">
                            <div class="col-xs-6 col-md-4 col-lg-3 form-group">
                                <label for="ceafl{{ i }}">Organ/Location</label>
                                <select name="ceafl{{ i }}" id="ceafl{{ i }}" class="form-control">
                                    <option value="-">-
                                    <option value="b">Breast
                                    <option value="a">Abdomen
                                    <option value="h">Head
                                    <option value="n">Neck
                                </select>
                            </div>
                            <div class="col-xs-6 col-md-8 col-lg-9 form-group">
                                <label for="ceafo{{ i }}">Describe</label>
                                <input type="text" name="ceafo{{ i }}" id="ceafo{{ i }}" class="form-control"/>
                            </div>
                        </div>
                    {% endfor %}
                    <div class="form-group">
                        <label for="ceafmc">Comments</label>
                        <textarea id="ceafmc" name="ceafmc" class="form-control"></textarea>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-12 form-group">
                    <label for="ceofo">Any other findings</label>
                    <textarea name="ceofo" id="ceofo" class="form-control"></textarea>
                </div>
            </div>

            <hr/>
            <h3>Follow Up</h3>
            <div class="row">
                <div class="col-md-6 form-group">
                    <label for="cefu">Follow-up</label>
                    <select name="cefu" class="form-control" required="required">
                        <option value="-"> -
                        <option value="rs"> annual repeat CT
                        <option value="dx"> f/u CT
                        <option value="af"> Abx + f/u CT
                        <option value="pe"> PET
                        <option value="cc"> CT w contrast
                        <option value="fn"> CT-guided biopsy
                        <option value="br"> bronchoscopy
                        <option value="va"> VAT
                        <option value="su"> resection
                    </select>
                </div>
                <div class="col-md-6 form-group">
                    <label for="cefuw-nw">When</label>
                    {{ f.datepicker("cefud", false, "Follow up date is required") }}
                    <br/>
                    {{ f.inlineRadio("cefuw", "cefuw-nw", "nw", "now") }}
                    {{ f.inlineRadio("cefuw", "cefuw-nw", "1m", "1 month") }}
                    {{ f.inlineRadio("cefuw", "cefuw-nw", "3m", "3 months") }}
                    {{ f.inlineRadio("cefuw", "cefuw-nw", "6m", "6 months") }}
                    {{ f.inlineRadio("cefuw", "cefuw-nw", "1y", "1 year") }}
                    {{ f.inlineRadio("cefuw", "cefuw-nw", "os", "other") }}
                </div>
            </div>

            <hr/>
            <h3>Impression</h3>
            <div class="row">
                <div class="col-md-12 form-group">
                    <label for="ceimn-rs">Nodules</label>
                    <div class="radio">
                        <label>
                            <input type="radio" name="ceimn" id="ceimn-rs" value="rs" required="required"> No evidence
                            of
                            abnormal uptake. Follow-up as recommended above.
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="ceimn" id="ceimn-ro" value="ro" required="required"> Uptake as
                            described above. Follow-up as recommended above.
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="ceimn" id="ceimn-ru" value="ru" required="required"> Nodule(s)
                            unchanged, as described above. Follow-up as recommended above.
                        </label>
                    </div>

                </div>
            </div>
            <div class="row">
                <div class="col-md-12 form-group">
                    <label for="ceimo-no">Other Findings</label>
                    <div class="radio">
                        <label>
                            <input type="radio" name="ceimo" id="ceimo-rs" value="rs" required="required"> No other
                            abnormalities.
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="ceimo" id="ceimo-oa" value="oa" required="required"> Other
                            abnormalities
                            and suggested follow-up as described above.
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="ceimo" id="ceimo-da" value="da" required="required"> Diffuse
                            abnormalities.
                        </label>
                    </div>

                </div>
            </div>
            <div class="row">
                <div class="col-md-12 form-group">
                    <label for="ceimre">Impression Remarks</label>
                    <textarea name="ceimre" id="ceimre" class="form-control"></textarea>
                </div>
            </div>

            <hr/>
            <div class="pull-left">
                <a class="btn btn-danger navigation" data-method="{{ formMethod }}" data-samiroute="deleteform"
                   href="{{ "pet.html" if mockup else "#!" }}" data-form="@@FORMKEY@@">
                    <span class="glyphicon glyphicon-trash"></span>Delete</a>
            </div>
            <div class="pull-right">
                <input type="hidden" name="samistatus" value=""/>
                <button type="submit" class="btn btn-default" id="save-for-later-button">Save for Later</button>
                <button type="submit" class="btn btn-primary" id="submit-button">Submit</button>
            </div>
        </form>
    </div>
{% endblock %}

{% block script %}
    <script language="JavaScript">


        $(function () {

            //follow up date calculator.
            $("[name=cefuw]").on("change", function () {
                switch ($(this).val()) {
                    case "nw":
                        $("#cefud").val(moment().format(VAPALS.DATE_FORMAT));
                        break;
                    case "1m":
                        $("#cefud").val(moment().add(1, 'month').format(VAPALS.DATE_FORMAT));
                        break;
                    case "3m":
                        $("#cefud").val(moment().add(3, 'month').format(VAPALS.DATE_FORMAT));
                        break;
                    case "6m":
                        $("#cefud").val(moment().add(6, 'month').format(VAPALS.DATE_FORMAT));
                        break;
                    case "1y":
                        $("#cefud").val(moment().add(1, 'year').format(VAPALS.DATE_FORMAT));
                        break;
                    default:
                        $("#cefud").val("").focus();
                }
            })

            $(".validated").formValidation({framework: 'bootstrap'});
        });
    </script>

{% endblock %}