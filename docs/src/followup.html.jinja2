{% extends 'layout.jinja2' %}
{% import 'forms.jinja2' as f %}
{% block title %}{{ title | escape }}{% endblock %}

{% block body %}
    <div class="container-fluid" style="max-width:1550px">
        <h1>
            Sample, Sammy G
            <small class="text-muted" title="Study ID">ST0001</small>
        </h1>
        <h2>{{ title | escape }}
            <small class="text-muted" title="Medical Record Number">1234567890</small>
        </h2>

        <hr/>
        <form action="{{ "followup.html" if mockup else "/vapals" }}" method="{{ formMethod }}"
              class="validated"
              data-fv-icon-valid="glyphicon glyphicon-ok"
              data-fv-icon-invalid="glyphicon glyphicon-remove"
              data-fv-icon-validating="glyphicon glyphicon-refresh"
              data-fv-button-selector="#submit-button">
            <div class="row">
                <div class="form-group col-sm-3 col-md-3 col-lg-2">
                    <label for="sidof">Follow-up Date</label>
                    {{ f.datepicker("sidof", true) }}
                </div>
                <div class="form-group col-sm-3 col-md-3 col-lg-2">
                    <label for="sidoe">Date of Baseline CT</label>
                    {{ f.datepicker("sidoe", true) }}
                </div>


                <div class="col-sm-4 col-md-3 form-group">
                    <label for="sico">Coordinator</label>
                    <input type="text" name="sico" id="sico" class="form-control" required="required"/>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-4 col-md-3">
                    <div id="sitsb-alert" class="alert alert-info" style="display: none;">
                        Time since baseline: <span id="sitsb-text">0</span> months
                    </div>
                    <input type="hidden" class="form-control" id="sitsb" name="sitsb"/>
                </div>
            </div>

            <hr/>

            <h3>Ordering Information</h3>
            <div class="alert alert-warning">Ordering information is required <strong>ONLY</strong> for
                Medicare/Medicaid patients.
            </div>
            <div class="row">
                <div class="col-md-4">
                    {{ f.floatingLabel('simeq-n', 'Was a CT lung screening scan ordered for this patient?') }}
                </div>
                <div class="form-group col-sm-8">
                    <div>
                        {{ f.inlineRadio("simeq", "simeq-n", "n", "no", true) }}
                        {{ f.inlineRadio("simeq", "simeq-y", "y", "yes", true) }}
                    </div>
                </div>
            </div>
            <div id="order-container">
                <div class="row">
                    <div class="col-md-4">
                        {{ f.floatingLabel('siopln', 'Ordered by') }}
                    </div>
                    <div class="col-md-4 form-group">
                        <input type=text name="siopln" class="form-control">
                        <span class="help-block small">First Name</span>
                    </div>
                    <div class="col-md-4 form-group">
                        <input type=text name="siopln" class="form-control">
                        <span class="help-block small">Last Name</span>

                    </div>
                </div>

                <div class="row">
                    <div class="col-md-4">
                        {{ f.floatingLabel('siopnpi', 'National Provider ID (NPI)') }}
                    </div>
                    <div class="col-sm-2 form-group">
                        <input type=text name="siopnpi" class="form-control numeric" required="required">
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-4">
                        {{ f.floatingLabel('sidsd-n', 'Documentation of shared decision making') }}
                    </div>
                    <div class="col-sm-8 form-group">
                        {{ f.inlineRadio("sidsd", "sidsd-n", "n", "no", true) }}
                        {{ f.inlineRadio("sidsd", "sidsd-y", "y", "yes", true) }}
                        <p class="help-block small">(shared decision making is required for reimbursement for G0297
                            exams on baseline <strong>only</strong>)</p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4">
                        {{ f.floatingLabel('siopss-c', 'Reported smoking status at time of order') }}
                    </div>
                    <div class="col-sm-8 form-group">
                        {{ f.inlineRadio("siopss", "siopss-c", "c", "current", true) }}
                        {{ f.inlineRadio("siopss", "siopss-f", "f", "former", true) }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-4">
                        {{ f.floatingLabel('siopqy', 'Reported pack years at time of order') }}
                    </div>
                    <div class="col-md-8 form-group">
                        <input type="text" name="sioppy" id="sioppy" class="form-control numeric" required="required"/>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4">
                        {{ f.floatingLabel('siopqy', 'Reported years since quit at time of order') }}
                    </div>
                    <div class="col-md-8 form-group">
                        <input type="text" name="siopqy" id="siopqy" class="form-control numeric"/>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-4">
                        {{ f.floatingLabel('sioas', 'Reported asymptomatic for lung cancer at time of order') }}
                    </div>
                    <div class="col-md-8 form-group">
                        {{ f.inlineRadio("sioas", "sioas-n", "n", "no", true) }}
                        {{ f.inlineRadio("sioas", "sioas-y", "y", "yes", true) }}
                    </div>
                </div>
                <hr/>
            </div>
            <div class="row">
                <div class="col-md-4">
                    {{ f.floatingLabel('siopci', 'Clinical Information') }}
                </div>
                <div class="col-md-8 form-group">
                    <textarea class="form-control" id="siopci" name="siopci" rows="3" required="required"></textarea>
                    <small class="form-text text-muted">information will be copied to CT report</small>
                </div>
            </div>
            <hr/>
            <div class="row">
                <div class="col-md-4">
                    {{ f.floatingLabel('siabx-n', 'Have you taken antibiotics since your last CT scan?') }}
                </div>
                <div class="col-md-8 form-group">
                    {{ f.inlineRadio("siabx", "siabx-n", "n", "no", true) }}
                    {{ f.inlineRadio("siabx", "siabx-y", "y", "yes", true) }}
                </div>
            </div>
            <div class="row">
                <div class="col-md-4">
                    {{ f.floatingLabel('siaex-n', 'Is this an annual CT scan?') }}
                </div>
                <div class="col-md-8 form-group">
                    {{ f.inlineRadio("siaex", "siaex-n", "n", "no", true) }}
                    {{ f.inlineRadio("siaex", "siaex-y", "y", "yes", true) }}
                </div>
            </div>


            <hr/>

            <div class="row">
                <div class="col-md-4">
                    {{ f.floatingLabel('sisse-1', 'Which year did you last have a prolonged exposure to secondhand tobacco smoke?') }}
                </div>
                <div class="col-md-8 form-group">
                    {{ f.inlineRadio("sisse", "sisse-1", "1", "less than 5 years ago", true) }}
                    {{ f.inlineRadio("sisse", "sisse-5", "5", "more than 5 years ago", true) }}
                    {{ f.inlineRadio("sisse", "sisse-10", "10", "more than 10 years ago", true) }}
                </div>
            </div>

            <hr/>

            <div class="row">
                <div class="col-md-4">
                    {{ f.floatingLabel('siwc-b', 'During the past year, have you experienced any of these symptoms?') }}
                </div>
                <div class="col-md-8 form-group">
                    {{ f.checkbox("siwcb", "b", "cough producing bloody material") }}
                    {{ f.checkbox("siwcl", "l", "unexplained weight loss greater than 20 lbs") }}
                    {{ f.checkbox("siwch", "h", "unexplained hoarseness") }}
                    {{ f.checkbox("siwco", "o", "other") }}
                    <input type="text" class="form-control input-sm" id="siwcos" name="siwcos" required="required"/>
                </div>
            </div>
            <div class="row">
                <div class="col-md-4">
                    {{ f.floatingLabel('siwcp-n', 'If yes, have you seen a physician for this?') }}
                </div>
                <div class="col-md-2 form-group">
                    {{ f.inlineRadio("siwcp", "siwcp-n", "n", "no") }}
                    {{ f.inlineRadio("siwcp", "siwcp-y", "y", "yes") }}
                </div>
                <div class="col-md-6 form-group" id="siwcw-container">
                    <label class="control-label" for="siwcw">Whom?</label>
                    <input type="text" id="siwcw" name="siwcw" class="form-control"/>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4">
                    {{ f.floatingLabel('siwcp-n', 'If yes, are you now experiencing them?') }}
                </div>
                <div class="col-md-8 form-group">
                    {{ f.inlineRadio("siwcn", "siwcn-n", "n", "no") }}
                    {{ f.inlineRadio("siwcn", "siwcn-y", "y", "yes") }}
                </div>
            </div>

            <div class="row">
                <div class="col-md-4">
                    {{ f.floatingLabel('siact', 'When did you most recently have a chest CT?') }}
                </div>
                <div class="col-md-8 form-group">
                    <select id="siact" name="siact" class="form-control">
                        <option value="-"> -
                        <option value="a"> less than 6 months ago
                        <option value="b"> 6-18 months ago
                        <option value="f"> 18 months to 3 years ago
                        <option value="c"> 3 years to 5 years ago
                        <option value="d"> over 5 years ago
                        <option value="e"> never
                    </select>
                </div>
            </div>

            <hr/>
            <div class="row">
                <div class="col-md-4 col-lg-6">
                    {{ f.floatingLabel('siho-n', 'Have you been hospitalized in the past year?') }}
                </div>
                <div class="col-md-2 form-group">
                    {{ f.inlineRadio("siho", "siho-n", "n", "no", true) }}
                    {{ f.inlineRadio("siho", "siho-y", "y", "yes", true) }}
                </div>
                <div class="col-md-6 col-lg-4" id="siho-container">
                    <div class="form-group">
                        <label for="sihow" class="control-label">For what?</label>
                        <input type=text id="sihow" name="sihow" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="sihod">When?</label>
                        {{ f.yearpicker("sihod", true) }}
                    </div>
                    <div class="form-group">
                        <label for="sihol">Where?</label>
                        <input type=text id="sihol" name="sihol" class="form-control">
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-lg-6">
                    {{ f.floatingLabel('sicd-n', 'Have you had a diagnosis of cancer in the past year?') }}
                </div>
                <div class="col-md-2 form-group">
                    {{ f.inlineRadio("sicd", "sicd-n", "n", "no", true) }}
                    {{ f.inlineRadio("sicd", "sicd-y", "y", "yes", true) }}
                </div>
                <div class="col-md-6 col-lg-4" id="sicd-container">
                    <div class="form-group">
                        <label for="sicdl" class="control-label">What part of the body?</label>
                        <select id="sicdl" name="sicdl" class="form-control">
                            <option value="-"> -
                            <option value="br"> breast
                            <option value="co"> colon / rectum
                            <option value="li"> liver
                            <option value="lu"> lung / bronchus
                            <option value="ov"> ovary
                            <option value="pa"> pancreas
                            <option value="pr"> prostate
                            <option value="sk"> skin
                            <option value="st"> stomach
                            <option value="ut"> uterus
                            <option value="os"> other (specify)
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="sicdls">Other?</label>
                        <input type=text id="sicdls" name="sicdls" class="form-control input-sm">
                    </div>
                    <div class="form-group">
                        <label for="sicdd">When were you diagnosed?</label>
                        {{ f.datepicker("sicdd", true) }}
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-lg-6">
                    {{ f.floatingLabel('silcs-n', 'If lung cancer has been diagnosed, have you had surgery?') }}
                </div>
                <div class="col-md-2 form-group">
                    {{ f.inlineRadio("silcs", "silcs-n", "n", "no", true) }}
                    {{ f.inlineRadio("silcs", "silcs-y", "y", "yes", true) }}
                </div>
                <div class="col-md-6 col-lg-4" id="silcs-container">
                    <div class="form-group">
                        <label for="silcsd">When?</label>
                        {{ f.datepicker("silcsd", true) }}
                    </div>
                    <div class="form-group">
                        <label for="silcsl">Where?</label>
                        <input type=text id="silcsl" name="silcsl" class="form-control">
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 col-lg-6">
                    {{ f.floatingLabel('sier-n', 'If a lung cancer has been removed, is there evidence of recurrence?') }}
                </div>
                <div class="col-md-2 form-group">
                    {{ f.inlineRadio("sier", "sier-n", "n", "no", true) }}
                    {{ f.inlineRadio("sier", "sier-y", "y", "yes", true) }}
                </div>
                <div class="col-md-6 col-lg-4" id="sier-container">
                    <div class="form-group">
                        <label for="sierd">Describe</label>
                        <input type=text id="sierd" name="sierd" class="form-control">
                    </div>
                </div>
            </div>


            <h3>Smoking</h3>


            <div class="row">
                <div class="col-md-4">
                    {{ f.floatingLabel('sisa-n', 'Over the past month, have you smoked cigarettes at all, even a puff?') }}
                </div>
                <div class="col-md-8 form-group">
                    {{ f.inlineRadio("sisa", "sisa-n", "n", "no", true) }}
                    {{ f.inlineRadio("sisa", "sisa-y", "y", "yes", true) }}
                    {{ f.inlineRadio("sisa", "sisa-o", "o", "never smoked", true) }}
                </div>
            </div>

            <div id="sisa-container-y">
                <div class="row">
                    <div class="col-md-4">
                        {{ f.floatingLabel('sidpw', 'On average, on how many days per week are you currently smoking cigarettes?') }}
                    </div>
                    <div class="col-md-1 form-group">
                        <input type=text id="sierd" name="sierd" class="form-control numeric">
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4">
                        {{ f.floatingLabel('sippd', 'On average, on the days that you are smoking cigarettes, how many packs of cigarettes are you currently smoking per day (PPD)?') }}
                    </div>
                    <div class="col-md-1 form-group">
                        <input type=text id="sippd" name="sippd" class="form-control numeric">
                    </div>
                </div>
            </div>
            <div id="sisa-container-n">
                <div class="row">
                    <div class="col-md-4">
                        {{ f.floatingLabel('sidlcd', 'When was the date of your last cigarette?') }}
                    </div>
                    <div class="col-md-4">
                        <div class="form-group" style="float:left;">
                            <select class="form-control input-sm" id="sidlcd" name="sidlcd"
                                    title="Last cigarette day">
                                <option value="-" selected>&mdash;</option>
                                {% for i in range(0,31) %}
                                    <option value="{{ i + 1 }}">{{ i + 1 }}</option>
                                {% endfor %}
                            </select>
                            <span class="small text-muted">Day</span>
                        </div>
                        <div class="form-group" style="float:left;">
                            <select class="form-control input-sm" id="sidlcm" name="sidlcm"
                                    title="Last cigarette month">
                                <option value="-" selected>&mdash;</option>
                                <option value="1">Jan</option>
                                <option value="2">Feb</option>
                                <option value="3">Mar</option>
                                <option value="4">Apr</option>
                                <option value="5">May</option>
                                <option value="6">Jun</option>
                                <option value="7">Jul</option>
                                <option value="8">Aug</option>
                                <option value="9">Sep</option>
                                <option value="10">Oct</option>
                                <option value="11">Nov</option>
                                <option value="12">Dec</option>
                            </select>
                            <span class="small text-muted">Month</span>
                        </div>

                        <div class="form-group" style="float:left;">
                            {{ f.yearpicker("sidlcy", true, false, true, "Year") }}

                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4">
                    {{ f.floatingLabel('sittq-n', 'Since your prior CT scan, have you ever tried to quit smoking?') }}
                </div>
                <div class="col-md-8 form-group">
                    {{ f.inlineRadio("sittq", "sittq-n", "n", "no", true) }}
                    {{ f.inlineRadio("sittq", "sittq-y", "y", "yes", true) }}
                    {{ f.inlineRadio("sittq", "sittq-o", "o", "n/a", true) }}
                </div>
            </div>

            <div class="row" id="sittq-container">
                <div class="col-md-4">
                    {{ f.floatingLabel('sittqt', 'How many times have you quit smoking for at least 24 hours?') }}
                </div>
                <div class="col-md-1 form-group">
                    <input type=text id="sittqt" name="sittqt" class="form-control numeric">
                </div>
            </div>

            <div class="row">
                <div class="col-sm-4">
                    {{ f.floatingLabel('', 'Since your prior CT scan, what, if any, smoking cessation methods have you used?') }}

                </div>
                <div class="col-sm-8">
                    {{ f.checkbox("sisca", "a","Have not tried to quit") }}
                    {{ f.checkbox("siscb", "b","\"Cold Turkey\" by completely stopping on your own with no other assistance") }}
                    {{ f.checkbox("siscc", "c","Tapering or reducing number of cigarettes smoked per day") }}
                    {{ f.checkbox("siscd", "d","Self-help material (e.g., brochure, cessation website)") }}
                    {{ f.checkbox("sisce", "e","Individual consultation or cessation counseling") }}
                    {{ f.checkbox("siscf", "f","Telephone cessation counseling hotline (e.g., NY Smokers' Quitline)") }}
                    {{ f.checkbox("siscg", "g","Peer support (e.g., Nicotine Anonymous)") }}
                    {{ f.checkbox("sisch", "h","Nicotine replacement therapy (e.g., patch, gum, inhaler, nasal spray, lozenge)") }}
                    {{ f.checkbox("sisci", "i","Zyban") }}
                    {{ f.checkbox("siscj", "j","Hypnosis") }}
                    {{ f.checkbox("sisck", "k","Acupuncture / acupressure") }}
                    {{ f.checkbox("siscl", "l","Other (specify)") }}
                    <input type="text" class="form-control input-sm" id="siscos" name="siscos" required="required"/>

                </div>
            </div>

            <div class="row">
                <div class="col-md-4">
                    {{ f.floatingLabel('siqst', 'Are you seriously thinking of quitting smoking?') }}
                </div>
                <div class="col-md-8 form-group">
                    <select id="siqst" name="siqst" class="form-control">
                        <option value="-"> -
                        <option value="y"> yes, within the next 30 days
                        <option value="m"> yes, within the next 6 months
                        <option value="n"> no, not thinking of quitting
                        <option value="o"> n/a
                    </select>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4">
                    {{ f.floatingLabel('sicpd-n', 'Smoking cessation materials were distributed to subject?') }}
                </div>
                <div class="col-md-8 form-group">
                    {{ f.inlineRadio("sicpd", "sittq-n", "n", "no", true) }}
                    {{ f.inlineRadio("sicpd", "sittq-y", "y", "yes", true) }}
                </div>
            </div>

            <div class="pull-right">
                <input type="hidden" name="samistatus" value=""/>
                <button type="submit" class="btn btn-default" id="save-for-later-button">Save for Later</button>
                <button type="submit" class="btn btn-primary" id="submit-button">Submit</button>
            </div>
        </form>
    </div>
{% endblock %}

{% block script %}
    <script language="JavaScript">

        $(function () {
            var $tsbFields = $("#sidof, #sidoe");
            $tsbFields.closest(".datepicker").on("dp.change", function () {
                var baselineDate = $("#sidof").val();
                var studyDate = $("#sidoe").val();
                var months = VAPALS.computeMonthsBetween(baselineDate, studyDate);
                $("#sitsb-text").text(months);
                $("#sitsb-alert").toggle(months > 0);
                $("#sitsb").val(months);
            }); //latch onto datetimepicker change events
            $tsbFields.filter(function () {
                return $(this).val();
            }).first().trigger("dp.change"); //trigger on page load for existing data;

            $("[name=simeq]").conditionallyEnable({enable: "#order-container"});
            $("#siwco").conditionallyEnable({sourceValues: "o", enable: "#siwcos"});
            $("[name=siwcp]").conditionallyEnable({enable: "#siwcw-container"});
            $("[name=siho]").conditionallyEnable({enable: "#siho-container"});
            $("#sicdl").conditionallyEnable({sourceValues: "os", enable: "#sicdls"});
            $("[name=sicd]").conditionallyEnable({enable: "#sicd-container"});
            $("[name=silcs]").conditionallyEnable({enable: "#silcs-container"});
            $("[name=sier]").conditionallyEnable({enable: "#sier-container"});
            $("[name=sisa]").conditionallyEnable({enable: "#sisa-container-y", disable: "sisa-container-n"});
            $("[name=sittq]").conditionallyEnable({enable: "#sittq-container"});
            $("#siscl").conditionallyEnable({sourceValues: "l", enable: "#siscos"})
        });

    </script>

{% endblock %}